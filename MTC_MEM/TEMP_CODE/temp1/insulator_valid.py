import matplotlib.pyplot as plt
import numpy as np
from insulator import Insulation

# a = np.arange(10)
# b = np.where(a<2,0,100)
# print(b)
a = Insulation(Do=0.064 + 0.2 * 2, Din=0.064, n=1, location=0, comp=["CO2", "H2", "Methanol", "H2O", "CO"])

# F = np.array([0.01648808,0.053253395,0.005706938,0.006874702,0.001894577])
# F = np.array([0.019077724, 0.062039308, 0.002982577, 0.005385645, 0.002403068])
# F = np.array([0.01928792,0.062722804,0.002745927,0.005175449,0.002429523])
F = np.array([0.015152885,0.047442573,0.007247335,0.007442657,0.000991958])
# F = np.array([0.02006272,0.065285,0.00185223,0.00440065,0.00254842])
Tr = 461  # 532.2024346

P = 75  # 75

Tc = 358
# res = a.flux(Th=Tr, Pp=Pp, F_dict=F, Tc=Tc)

q = []
for Tc in np.arange(363, 413, 100):
    res = a.flux(Th=Tr, P=P, F_dict=F, Tc=Tc)
    print(res)
    qs = res['hflux'] / res['mflux']
    q.append([Tc, -qs[2], -qs[3], -qs[2] - qs[3]])
q = np.array(q)
plt.plot(q[:, 0], q[:, 1],'r')
plt.plot(q[:, 0], q[:, 2],'g')
plt.plot(q[:, 0], q[:, 3],'b')
plt.show()
# [-0.        , -0.        , -0.00112712, -0.00302586, -0.        ]
# 476.35552208436775
# CO2         0.195779
# H2          0.632330
# Methanol    0.067764
# H2O         0.081630
# CO          0.022496

######
# Tc=358
# CO2         0.222835
# H2          0.724280
# Methanol    0.020103
# H2O         0.007014
# CO          0.025768
# dtype: float64
# {'mflux': array([-0., -0., -0.00132523, -0.00302338, -0.        ]), 'hflux': 520.7196399957083, 'hlg': 169.58217082874145, 'Tvar': -175.57629212885152, 'dev': -0.7331040671350709, 'ht': 551.7749032094097}
# add the iteration on r
# {'mflux': array([-0.        , -0.        , -0.00121656, -0.00179347, -0.        ]), 'hflux': 525.9171195693501, 'hlg': 115.06361646182509, 'Tvar': -177.32877872982357, 'dev': 0.0013279012931604569, 'ht': 548.4807443792737}
# no itration
# {'mflux': array([-0.        , -0.        , -0.00121676, -0.00179577, -0.        ]), 'hflux': 525.9074068063526, 'hlg': 115.16528903483129, 'Tvar': -177.32550377957693, 'dev': 1.0625508378762025e-17, 'ht': 548.4868475193239}


######
# Tc=373
# CO2         0.219416
# H2          0.712072
# Methanol    0.030393
# H2O         0.012785
# CO          0.025334
# dtype: float64
# {'mflux': array([-0., -0., -0.00112712, -0.00302586, -0. ]), 'hflux': 476.35552208436775, 'hlg': 159.47584913548013, 'Tvar': -160.6175951100401, 'dev': -0.7903377123475311, 'ht': 503.9610384180914}

# add the iteration on r
# {'mflux': array([-0.        , -0.        , -0.00100225, -0.00169157, -0.        ]), 'hflux': 481.78856565506493, 'hlg': 101.18906860881083, 'Tvar': -162.4495091994057, 'dev': 0.010594539499114436, 'ht': 500.52773376541273}
